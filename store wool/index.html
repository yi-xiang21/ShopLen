<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/ai-integration.js"></script>
    <title>peace chill</title>
</head>

<body>
   
    <main>
        <section id="banner">
            <div class="text-banner">
                <p class="p1">Discover The Relax Your Soul </p>
                <p class="p2">WorkShop weekly to inspire your creativily</p>
                <div class="button-banner">
                    <a class="button-bannerL" href="Shop.html">Shop Collection</a>
                    <a class="button-bannerR" href="workshop.html">Join Workshops</a>
                </div>
            </div>
        </section>
        <section id="Collection">
            <div class="title-collection">
                <p class="title-collection-1">Our Wool Collection</p>
                <p class="title-collection-2">hight-quality yarns for all your knitting projects</p>
            </div>
            <div class="Collection-item">
                <div class="item">
                    <div class="item-img">
                        <img src="img/down1.png" alt="Item 1">
                    </div>
                    <img src="img/collection1.png" alt="">
                    <p class="p-item1">Merino Wool</p>
                    <p class="p-item2">soft and luxurios</p>
                    <a href="Shop.html">Show me</a>
                </div>
                <div class="item">
                    <div class="item-img">
                        <img src="img/down2.png" alt="Item 2">
                    </div>
                    <img src="img/collection2.png" alt="">
                    <p class="p-item1">Alpaca Blend</p>
                    <p class="p-item2">Warm and cozy</p>
                    <a href="Shop.html">Show me</a>
                </div>
                <div class="item">
                    <div class="item-img">
                        <img src="img/down3.png" alt="Item 3">
                    </div>
                    <img src="img/collection3.png" alt="">
                    <p class="p-item1">Organic Cotton</p>
                    <p class="p-item2">Breathable and light</p>
                    <a href="Shop.html">Show me</a>
                </div>
                <div class="item">
                    <div class="item-img">
                        <img src="img/down4.png" alt="Item 4">
                    </div>
                    <img src="img/collection4.png" alt="">
                    <p class="p-item1">Hand-Dyed Specialty</p>
                    <p class="p-item2">Unique and vibrant</p>
                    <a href="Shop.html">Show me</a>
                </div>
            </div>
        </section>
        <section id="banner-mid">
            <div class="text-bannermid">
                <p class="title-bannermid">This Week's Workshop</p>
                <p class="head-bannermid">Spring Flowers Scarf</p>
                <p class="content-bannermid">
                    this Saturday for a guided
                    workshop where you'll
                    learn to create a beautiful floral-inspired scarf using our
                    premium merino wool !
                </p>
                <ul class="list-info">
                    <li>üìÖ Saturday, May 27th, 2025</li>
                    <li>üïí 10:00 AM ‚Äì 12:30 PM</li>
                    <li>üìç In-store & Online via Zoom</li>
                    <li>üè∑Ô∏è $45 (includes materials)</li>
                </ul>
                <div class="button-bannermid">
                    <a href="workshop.html">Join Workshops</a>
                </div>
            </div>
        </section>
        <section id="product">
            <div class="title-collection">
                <p class="title-collection-1">Best Seller</p>
                <p class="title-collection-2">Our most pupular yarns loved by our knitting community</p>
            </div>
            <div class="products-slider">
                <button class="slider-btn left"><i class="bi bi-arrow-left"></i></button>
                <div class="products-item" id="products-list">
                    <!-- Products will be rendered here by JS (fetched from api/api.json) -->
                </div>
                <button class="slider-btn right"><i class="bi bi-arrow-right"></i></button>

            </div>
            <div class="more-pro">
                <a href="Shop.html">View More Item</a>
            </div>
        </section>
        <section>
            <div id="community">
                <p class="title-community"> What Our community Says</p>
                <div id="community-say">
                    <div class="say1 said">
                        <div class="rating-stars">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                        <p>" The quality of the wool is exceptional, and the weekly workshops have helped me improve my
                            knitting skills tremendously. I love the friendly community ! "</p>
                        <div id="customer">
                            <img src="img/cus1.png" alt="">
                            <p>Emma</p>
                        </div>

                    </div>
                    <div class="say2 said">
                        <div class="rating-stars">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        </div>
                        <p>" As a beginner, I was nervous about joining a workshop, but the instructors are so patient
                            and helpful. The merino wool is so soft and easy to work with ! "</p>
                        <div id="customer">
                            <img src="img/cus2.png" alt="">
                            <p>Emma</p>
                        </div>
                    </div>
                    <div class="say3 said">
                        <div class="rating-stars">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star"></i>
                        </div>
                        <p>" I've been knitting for years, but the weekly themed workshops always inspire me to try new
                            techniques. The hand-dyed yarn collection is simply gorgeous so happy! "</p>
                        <div id="customer">
                            <img src="img/cus3.png" alt="">
                            <p>Emma</p>
                        </div>
                    </div>
                </div>
            </div>

        </section>
        <section id="instagram">
            <div class="title-collection">
                <p class="title-collection-1">Follow Us On instagram</p>
                <p class="title-collection-2">Share your creation with us using #WoollyPeace</p>
            </div>
            <div class="detail-insta">
                <div class="inta">
                    <img src="img/in1.png" alt="">
                </div>
                <div class="inta">
                    <img src="img/in2.png" alt="">
                </div>
                <div class="inta">
                    <img src="img/in3.png" alt="">
                </div>
                <div class="inta">
                    <img src="img/in4.png" alt="">
                </div>
                <div class="inta">
                    <img src="img/in5.png" alt="">
                </div>
            </div>
            <div class="insta-logo">
                <i class="bi bi-instagram"></i>
                <span>@PeaceAndChill</span>
            </div>

        </section>
        <section id="mail">
            <div class="mail-details">
                <p class="title-mail">Join Our knitting</p>
                <p class="conten-mail">Subscribe to our newsletter for weekly workshop updates , new yarn arrivals , and
                    exclusive patterns</p>

                <div class="mail-form">
                    <input type="email" placeholder="Your email address" required>
                    <button>Subscribe</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Render products dynamically from api/products.json -->
    <script>
        // Convert product from products.json format to display format
        function convertProductFormat(product) {
            // Get first variant image or main image
            const firstVariant = product.bien_the && product.bien_the.length > 0 ? product.bien_the[0] : null;
            const mainImage = firstVariant?.url_hinh_anh_bien_the || product.hinh_anh_url;
            
            // Calculate price with discount if applicable
            let finalPrice = product.gia || 0;
            if (product.khuyen_mai && product.khuyen_mai.length > 0) {
                const activePromo = product.khuyen_mai.find(promo => {
                    const now = new Date();
                    const start = new Date(promo.ngay_bat_dau);
                    const end = new Date(promo.ngay_ket_thuc);
                    return now >= start && now <= end;
                });
                if (activePromo) {
                    finalPrice = finalPrice * (1 - activePromo.phan_tram_giam / 100);
                }
            }
            
            return {
                id: product.ma_san_pham,
                name: product.ten_san_pham,
                cost: finalPrice,
                images: {
                    main: mainImage
                }
            };
        }

        // Format price in Vietnamese format
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(price);
        }

        (async function renderProducts() {
            const container = document.getElementById('products-list');
            if (!container) return;
            try {
                const res = await fetch('api/products.json');
                const data = await res.json();
                
                // Filter products: only show danh_muc 1 and 2, exclude 3 (Workshop)
                const filteredProducts = (data.products || []).filter(product => {
                    const categoryId = product.danh_muc?.ma_danh_muc;
                    return categoryId === 1 || categoryId === 2;
                });
                
                if (!filteredProducts.length) {
                    container.innerHTML = '<p style="padding:16px;">Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o.</p>';
                    return;
                }

                // Convert to display format
                const products = filteredProducts.map(product => convertProductFormat(product));

                container.innerHTML = products.map(p => `
                    <div class="product-item" data-id="${p.id || ''}">
                        <div class="product-inner">
                            <img src="${p.images.main || 'img/default.jpg'}" alt="${(p.name || '').replace(/"/g, '&quot;')}">
                            <p class="title-item">${p.name || ''}</p>
                            <p class="cost">${formatPrice(p.cost || 0)}</p>
                            <button class="btn-buy"><a href="detail.html?id=${p.id || ''}">Buy Now</a></button>
                        </div>
                    </div>
                `).join('');

                // Optional: attach handlers (e.g., buy button) if needed
                container.querySelectorAll('.btn-buy').forEach(btn => {
                    btn.addEventListener('click', function (e) {
                        // default anchor will navigate; you can implement cart logic here
                    });
                });

            } catch (err) {
                console.error('Error loading products:', err);
                container.innerHTML = '<p style="color:red; padding:16px;">Kh√¥ng th·ªÉ t·∫£i s·∫£n ph·∫©m.</p>';
            }
        })();
        // nut trai phai trong besst seller
        const productsItem = document.querySelector('.products-item');
        const btnLeft = document.querySelector('.slider-btn.left');
        const btnRight = document.querySelector('.slider-btn.right');
        if (btnLeft && productsItem) {
            btnLeft.onclick = () => {
                productsItem.scrollBy({ left: -productsItem.offsetWidth * 0.5, behavior: 'smooth' });
            };
        }
        if (btnRight && productsItem) {
            btnRight.onclick = () => {
                productsItem.scrollBy({ left: productsItem.offsetWidth * 0.5, behavior: 'smooth' });
            };
        }
    </script>
    <script src="js/header.js"></script>
    <script src="js/js.js"></script>
    <script src="js/footer.js" defer></script>
    <script src="js/breadcrumb.js" defer></script>

</body>

</html>